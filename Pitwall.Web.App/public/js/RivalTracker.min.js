!function(){for(var t=0,e=["webkit","moz"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var r=(new Date).getTime(),o=Math.max(0,16-(r-t)),a=window.setTimeout(function(){e(r+o)},o);return t=r+o,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var RivalTracker=RivalTracker=function(t,e,i,r){var o=void 0;for(name in RivalTracker.paths.tracks)if(trackObj=RivalTracker.paths.tracks[name],null!==trackObj.trackId&&""!==trackObj.paths[0]&&trackObj.trackId==e){(o=trackObj).name=name;break}void 0===o&&((o=RivalTracker.paths.tracks.default_map).name="default_map"),o.height=50,o.width=50,o.viewBox="0 0 600 600";var a,n,l,s=O(),d=O(),u={},c=.8,f=.8,b=.4,h=0,v=0,A={},m={},w=new Array,k=!0,C=Date.now(),p=document.getElementById(t);p.innerHTML="";var F=0,S=["#000066","#00FFFF","#0000FF","#80FF00","#808080","#00FF00","#A02820","#FF00FF","#008000","#800000","#000080","#808000","#FFA000","#800080","#FF0000","#C0C0C0","#008080","#F080F0","#FF0066","#CC3366","#996666","#669966","#33CC66","#00FF66","#FFCCCC","#CCCCCC","#99CCCC","#66CCCC","#33CCCC","#00FFCC","#330066","#9900FF","#6699FF","#6666CC","#996633","#330000","#330033","#990066"];void 0===r?r={scaling:100,maxPrediction:8e3,initialBuffer:500,pathColor:"#000000",pathStrokeWidth:6,nodeSize:15,nodeStrokeWidth:2,nodeStrokeColor:"#000000",labelFont:"Arial",labelFontSize:"11px",labelStrokeWidth:2,labelStrokeColor:"#000000",labelColor:"#FFFFFF",labelVertOffset:0,reportBufferStatus:!0}:(r.scaling=void 0===r.scaling?"100":r.scaling,r.maxPrediction=void 0===r.maxPrediction?8e3:r.maxPrediction,r.initialBuffer=void 0===r.initialBuffer?500:r.initialBuffer,r.pathColor=void 0===r.pathColor?"#000000":r.pathColor,r.pathStrokeWidth=void 0===r.pathStrokeWidth?6:r.pathStrokeWidth,r.nodeSize=void 0===r.nodeSize?15:r.nodeSize,r.nodeStrokeWidth=void 0===r.nodeStrokeWidth?2:r.nodeStrokeWidth,r.nodeStrokeColor=void 0===r.nodeStrokeColor?"#000000":r.nodeStrokeColor,r.labelFont=void 0===r.labelFont?"Arial":r.labelFont,r.labelFontSize=void 0===r.labelFontSize?"11px":r.labelFontSize,r.labelStrokeWidth=void 0===r.labelStrokeWidth?0:r.labelStrokeWidth,r.labelStrokeColor=void 0===r.labelStrokeColor?"#ffffff":r.labelStrokeColor,r.labelColor=void 0===r.labelColor?"#ffffff":r.labelColor,r.labelVertOffset=void 0===r.labelVertOffset?0:r.labelVertOffset,r.reportBufferStatus=void 0===r.reportBufferStatus||r.reportBufferStatus);var x,g,y=this;function W(t){d[t]=s[t];var e=z(d[t]);if(circle=A[t],void 0===circle){var i=document.createElementNS("http://www.w3.org/2000/svg","circle");i.setAttribute("id",t+"Node"),i.setAttribute("cx",e.x),i.setAttribute("cy",e.y),i.setAttribute("r",r.nodeSize),i.setAttribute("fill",S.length<1?function(){for(var t="0123456789ABCDEF".split(""),e="#",i=0;i<6;i++)e+=t[Math.round(15*Math.random())];return e+=99}():S.shift()+99),i.setAttribute("transform",r.transform),i.setAttribute("stroke",r.nodeStrokeColor),i.setAttribute("stroke-width",r.nodeStrokeWidth),"function"==typeof r.callback&&i.addEventListener("mousedown",r.callback,!1),y.svg.appendChild(i),A[t]=i;var o=document.createElementNS("http://www.w3.org/2000/svg","text");"function"==typeof r.callback&&o.addEventListener("mousedown",r.callback,!1),o.setAttribute("id",t+"Label"),o.setAttribute("x",e.x),o.setAttribute("y",e.y+r.nodeSize/4-r.labelVertOffset),o.setAttribute("fill",r.labelColor),o.setAttribute("font-family",r.labelFont),o.setAttribute("transform",r.transform),o.setAttribute("font-size",r.labelFontSize),o.setAttribute("font-weight","bolder"),o.setAttribute("stroke-width",r.labelStrokeWidth),o.setAttribute("stroke",r.labelStrokeColor),o.setAttribute("text-anchor","middle"),o.textContent=t,y.svg.appendChild(o),m[t]=o}else circle.setAttribute("display","inline"),circle.setAttribute("cx",e.x),circle.setAttribute("cy",e.y),(o=m[t]).setAttribute("display","inline"),o.setAttribute("x",e.x),o.setAttribute("y",e.y+r.nodeSize/4-r.labelVertOffset)}function B(t){circle=A[t],driverLabel=m[t],circle.setAttribute("display","none"),driverLabel.setAttribute("display","none")}function z(t){return 0===t&&(t+=1e-4),n.getPointAtLength(l/100*t)}function O(){var t={};for(var e in i)t[e]=i[e];return t}function L(){if(c=h<-50?b:f,E=!1,null!=(x=w.shift())){for(var t in x.expires=Date.now()+x.duration,r.maxPrediction>0&&(x.expires-=17),s=x.data,d)void 0===s[t]&&(B(t),delete d[t]);var e;for(var t in s)void 0===d[t]&&W(t),(e=s[t]-d[t])<-20&&(e+=100),e>90&&(e-=100),u[t]=e/x.duration}}this.svg=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","100%");var e=0===p.clientWidth?document.documentElement.clientWidth:p.clientWidth;t.setAttribute("width",e*r.scaling/100);var i=e*(r.height/100);return i=i*r.scaling/100,t.setAttribute("height",i),t.setAttribute("preserveAspectRatio","xMinYMin slice"),t.setAttribute("viewBox",o.viewBox),t.setAttribute("wmode","transparent"),t}(),function(){var t;for(var e in o.paths)(t=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",o.paths[e]),t.setAttribute("transform",r.transform),t.setAttribute("stroke-miterlimit","4"),t.setAttribute("stroke-width",r.pathStrokeWidth),t.setAttribute("stroke-dasharray","none"),t.setAttribute("stroke",r.pathColor),t.setAttribute("fill","none"),0==e?(t.setAttribute("id","trackPath"),t.setAttribute("stroke-opacity","1"),n=t):t.setAttribute("stroke-opacity","0.2"),y.svg.appendChild(t),l=n.getTotalLength();var i=z(0),a=z(.1),s=document.createElementNS("http://www.w3.org/2000/svg","line");s.setAttribute("x1",i.x),s.setAttribute("y1",i.y-15),s.setAttribute("x2",i.x),s.setAttribute("y2",i.y+15);var d=i.x-a.x,u=i.y-a.y,c=" rotate("+Math.atan(u/d)*(180/Math.PI)+" "+i.x+" "+i.y+")";s.setAttribute("transform",r.transform+c),s.setAttribute("stroke-width",r.pathStrokeWidth),s.setAttribute("stroke",r.pathColor),y.svg.appendChild(s)}(),document.getElementById(t).appendChild(y.svg),function(){for(var t in s)s.hasOwnProperty(t)&&W(t)}(),this.updatePositions=function(t){var e=O(),i=Date.now(),o=0,n=i-C;if(!(n<100)){if(void 0===t&&(t=Date.now()),void 0===a)var l=n;else l=t-a;if(h=F,v>0&&(F=0,n=l,k=!0,v=0),F<0){if(o+=F,(l+=F)<0)return;F=0}C=i,a=t,k&&(n+=r.initialBuffer,k=!1),(o+=n)<=0&&(o=1),w.push({data:e,duration:o}),F+=o,L()}};var E=!1;!function t(){requestAnimationFrame(t);var e=Date.now(),i=e-(g||e);if(g=e,null!=x){if(F-=i,e>=x.expires)if(w.length>0)L();else if(E=!0,e>=x.expires+r.maxPrediction)return E=!1,x=void 0,void(v=e);for(var o in s)if(circle=A[o],driverLabel=m[o],void 0!==u[o]){var a=u[o]*i;if(E){if(a<0)continue;a*=c}if(0!==n){var n=d[o]+a;n>100&&(n-=100),n<0&&(n+=100);var l=z(n);circle.setAttribute("cx",l.x),circle.setAttribute("cy",l.y),driverLabel.setAttribute("x",l.x),driverLabel.setAttribute("y",l.y+r.nodeSize/4-r.labelVertOffset),d[o]=n}}}}(),this.setNodeColor=function(t,e){null!=A[t]&&A[t].setAttribute("fill",e)},this.setNodeStrokeColor=function(t,e){null!=A[t]&&A[t].setAttribute("stroke",e)},this.setNodeStrokeWidth=function(t,e){A[t].setAttribute("stroke-width",e)},this.setNodeStrokeDash=function(t){A[t].setAttribute("stroke-dasharray","3,4")},this.setLabelColor=function(t,e){m[t].setAttribute("fill",e)},this.resetBuffer=function(){v=Date.now()}};